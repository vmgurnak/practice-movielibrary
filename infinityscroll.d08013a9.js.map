{"mappings":"YACA,IAAMA,EAAW,CACfC,UAAWC,SAASC,cAAc,kBAClCC,MAAOF,SAASC,cAAc,cAI1BE,EAEG,kBAFHA,EAGE,aAHFA,EAIK,QAIPC,EAAO,EAQLC,EAAW,IAAIC,sBA+DrB,SAAyBC,EAASC,GAChCD,EAAQE,SAAQ,SAAAC,GACdC,QAAQC,IAAIF,GACRA,EAAMG,gBAERC,EADAV,GAAQ,GAELW,MAAK,SAAAC,GACJlB,EAASC,UAAUkB,mBACjB,YACAC,EAAaF,EAAKG,UAEhBH,EAAKI,MAAQJ,EAAKK,aACpBb,EAASc,UAAUxB,EAASI,M,IAG/BqB,OAAM,SAAAC,GACLb,QAAQC,IAAIY,E,SApFN,CACdC,KAAM,KACNC,WAAY,OACZC,UAAW,IAKb,SAAST,EAAaU,GACpB,OAAOA,EACJC,KACC,SAAAC,G,IACEC,EAAWD,EAAXC,YACAC,EAAcF,EAAdE,eACAC,EAAYH,EAAZG,aACAC,EAAYJ,EAAZI,a,MACI,+CAKOC,OAHRJ,EACI,kCAAoCA,EACpC,iBACL,WAEQI,OAFCH,GAAkB7B,EAAe,2DAGrBgC,OADbH,GAAkB7B,EAAe,wCAEpBgC,OADAF,GAAgB9B,EAAc,uCACGgC,OAAjCD,GAAgB/B,EAAiB,qC,IAI3DiC,KAAK,G,CAIV,SAAStB,I,IAAauB,EAAAC,UAAAC,OAAA,YAAAD,UAAA,GAAiBA,UAAA,GAAH,IAC5BE,EAAS,IAAIC,gBAAgB,CACjCrB,KAAMiB,EACNK,QAAS,qCAEX,OAAOC,MAAM,oDAA2DR,OAAPK,IAC9DzB,MAAK,SAAA6B,GACJ,IAAKA,EAAKC,GACR,MAAM,IAAIC,MAAM,SAElB,OAAOF,EAAKG,M,IAEbxB,OAAM,SAAAC,GACLb,QAAQC,IAAIY,E,IAKlBV,IACGC,MAAK,SAAAC,GACJL,QAAQC,IAAII,GACZlB,EAASC,UAAUkB,mBACjB,YACAC,EAAaF,EAAKG,UAGhBH,EAAKI,KAAOJ,EAAKK,aACnBhB,EAAS2C,QAAQlD,EAASI,M,IAG7BqB,OAAM,SAAAC,GACLb,QAAQC,IAAIY,E","sources":["src/js/infinityscroll.js"],"sourcesContent":["// Elements object\nconst elements = {\n  container: document.querySelector('.js-movie-list'),\n  guard: document.querySelector('.js-guard'),\n};\n\n// Default markup values object\nconst defaults = {\n  poster: 'https://www.reelviews.net/resources/img/default_poster.jpg',\n  title: 'Title not found',\n  date: 'XXXX-XX-XX',\n  average: 'XX.XX',\n};\n\n// Variable for backend page number\nlet page = 1;\n\n// Intersection Observer\nconst options = {\n  root: null,\n  rootMargin: '50px',\n  threshold: 0,\n};\nconst observer = new IntersectionObserver(handlerLoadMore, options);\n\n// Markup function\nfunction createMarkup(arr) {\n  return arr\n    .map(\n      ({\n        poster_path,\n        original_title,\n        release_date,\n        vote_average,\n      }) => `<li class=\"movie-card\">\n         <img src=\"${\n           poster_path\n             ? 'https://image.tmdb.org/t/p/w300' + poster_path\n             : 'default.poster'\n         }\" alt=\"${original_title || defaults.title}\">\n         <div class=\"movie-info\">\n            <h2>${original_title || defaults.title}</h2>\n            <p>Release Date: ${release_date || defaults.date}</p>\n            <p>Vote Average: ${vote_average || defaults.average}</p>\n         </div>\n      </li>`\n    )\n    .join('');\n}\n\n// Function for backend request\nfunction serviceFilms(currentPage = '1') {\n  const params = new URLSearchParams({\n    page: currentPage,\n    api_key: '345007f9ab440e5b86cef51be6397df1',\n  });\n  return fetch(`https://api.themoviedb.org/3/trending/movie/week?${params}`)\n    .then(resp => {\n      if (!resp.ok) {\n        throw new Error('Error');\n      }\n      return resp.json();\n    })\n    .catch(err => {\n      console.log(err);\n    });\n}\n\n// Calling the serviceFilms() function, first loading, rendering markup\nserviceFilms()\n  .then(data => {\n    console.log(data);\n    elements.container.insertAdjacentHTML(\n      'beforeend',\n      createMarkup(data.results)\n    );\n    // Call observer\n    if (data.page < data.total_pages) {\n      observer.observe(elements.guard);\n    }\n  })\n  .catch(err => {\n    console.log(err);\n  });\n\n// Callback function for Intersection Observer\nfunction handlerLoadMore(entries, observer) {\n  entries.forEach(entry => {\n    console.log(entry);\n    if (entry.isIntersecting) {\n      page += 1;\n      serviceFilms(page)\n        .then(data => {\n          elements.container.insertAdjacentHTML(\n            'beforeend',\n            createMarkup(data.results)\n          );\n          if (data.page >= data.total_pages) {\n            observer.unobserve(elements.guard);\n          }\n        })\n        .catch(err => {\n          console.log(err);\n        });\n    }\n  });\n}\n"],"names":["$d23aefc60b3a52de$var$elements","container","document","querySelector","guard","$d23aefc60b3a52de$var$defaults","$d23aefc60b3a52de$var$page","$d23aefc60b3a52de$var$observer","IntersectionObserver","entries","observer1","forEach","entry","console","log","isIntersecting","$d23aefc60b3a52de$var$serviceFilms","then","data","insertAdjacentHTML","$d23aefc60b3a52de$var$createMarkup","results","page","total_pages","unobserve","catch","err","root","rootMargin","threshold","arr","map","param","poster_path","original_title","release_date","vote_average","concat","join","currentPage","arguments","length","params","URLSearchParams","api_key","fetch","resp","ok","Error","json","observe"],"version":3,"file":"infinityscroll.d08013a9.js.map"}